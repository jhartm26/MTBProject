import{_ as D,V as U,a as b,b as y,c as C}from"./VCard.fe71e90b.js";import{o as n,c as r,w as a,a as t,b as c,t as m,r as v,V as M,d as f,e as u,m as j,f as i,p as O,g as L,h as F,i as z,F as H,j as w,k as K}from"./index.84324f05.js";import{a as V}from"./accountsService.131ffccb.js";import{t as _,V as o,a as T,b as I,c as g,d as R,e as k,f as E,g as P,h as W,i as N}from"./VMain.6e411fe2.js";const q={props:{name:String,number:Number}},G={class:"text-h4 text--primary"};function J(e,s,h,S,A,d){return n(),r(b,{rounded:"lg",class:"ma-2",width:"max-content"},{default:a(()=>[t(U,null,{default:a(()=>[c("div",null,m(this.name),1),c("p",G,m(this.number),1)]),_:1})]),_:1})}const Q=D(q,[["render",J]]),X={data:()=>({loadingAccounts:!0,accounts:[],trails:[],search:"",dialog:!1,dialogDelete:!1,editedIndex:-1,formTitle:"",sortBy:[],editedItem:{uuid:"",account_name:"",page_id:"",trails:[]},defaultItem:{account_name:"",page_id:"",trails:[]},accountHeaders:[{title:"Account",value:"account_name",key:"account_name",sortable:!0},{title:"Twitter Account ID",value:"page_id",sortable:!0},{title:"Last Updated",value:"last_update",sortable:!0},{title:"Trails",value:"trails_table",key:"trails_table",sortable:!0},{title:"UUID",value:"uuid",align:" d-none"}]}),methods:{async loadAccounts(){this.loadingAccounts=!0;try{this.accounts=[],this.accounts=await V.getAccounts(),this.trails=[],this.trails=await _.getTrails(),this.loadingAccounts=!1}catch{this.loadingAccounts=!1}},editItem(e){this.editedIndex=this.accounts.indexOf(e),this.editedItem=Object.assign({},e),this.formTitle="Edit Account",this.dialog=!0},deleteItem(e){this.editedIndex=this.accounts.indexOf(e),this.editedItem=Object.assign({},e),this.formTitle="",this.dialogDelete=!0},async deleteItemConfirm(){await V.deleteAccount(this.editedItem.UUID||this.editedItem.uuid),await this.loadAccounts(),this.closeDelete()},close(){this.dialog=!1,this.formTitle="",this.$nextTick(()=>{this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1})},closeDelete(){this.dialogDelete=!1,this.formTitle="",this.$nextTick(()=>{this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1})},async save(){this.editedIndex>-1?await V.updateAccount(this.accounts[this.editedIndex],this.editedItem):await V.createAccount(this.editedItem),await this.loadAccounts(),this.close()},handleClick(e,s){const h=s.item.raw;this.$router.push(`/social-media/${h.uuid||h.UUID}`)}},created(){this.loadAccounts()}},Y=c("span",{class:"headline"},"Accounts",-1),Z={class:"text-h5"};function ee(e,s,h,S,A,d){const p=v("v-data-table");return n(),r(b,{rounded:"lg",width:"100%"},{default:a(()=>[t(y,null,{default:a(()=>[Y]),_:1}),t(M),t(p,{items:e.accounts,headers:e.accountHeaders,loading:e.loadingAccounts,search:e.search,"sort-by":e.sortBy,"onUpdate:sortBy":s[6]||(s[6]=l=>e.sortBy=l),"item-key":"uuid","onClick:row":d.handleClick},{top:a(()=>[t(o,{class:"d-flex mt-4",style:{"align-items":"center","max-width":"100%"}},{default:a(()=>[t(f,{modelValue:e.search,"onUpdate:modelValue":s[0]||(s[0]=l=>e.search=l),label:"Search",class:"mr-4 ml-5"},null,8,["modelValue"]),t(T,{modelValue:e.dialog,"onUpdate:modelValue":s[4]||(s[4]=l=>e.dialog=l),"max-width":"500px"},{activator:a(({props:l})=>[t(u,j({color:"primary",dark:"",class:"mb-2 mr-5 ml-2"},l),{default:a(()=>[i(" New Account ")]),_:2},1040)]),default:a(()=>[t(b,null,{default:a(()=>[t(y,null,{default:a(()=>[c("span",Z,m(e.formTitle||"Add Account"),1)]),_:1}),t(U,null,{default:a(()=>[t(I,null,{default:a(()=>[t(o,null,{default:a(()=>[t(g,null,{default:a(()=>[t(f,{modelValue:e.editedItem.account_name,"onUpdate:modelValue":s[1]||(s[1]=l=>e.editedItem.account_name=l),label:"Account Name"},null,8,["modelValue"])]),_:1}),t(g,null,{default:a(()=>[t(f,{modelValue:e.editedItem.page_id,"onUpdate:modelValue":s[2]||(s[2]=l=>e.editedItem.page_id=l),label:"Account Username"},null,8,["modelValue"])]),_:1})]),_:1}),t(o,null,{default:a(()=>[t(g,null,{default:a(()=>[t(R,{modelValue:e.editedItem.trails,"onUpdate:modelValue":s[3]||(s[3]=l=>e.editedItem.trails=l),items:e.trails,"item-title":"name","item-value":"UUID","return-object":"",chips:"","closable-chips":"",label:"Trails",multiple:""},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1})]),_:1}),t(C,null,{default:a(()=>[t(k),t(u,{color:"blue-darken-1",variant:"text",onClick:d.close},{default:a(()=>[i(" Cancel ")]),_:1},8,["onClick"]),t(u,{color:"blue-darken-1",variant:"text",onClick:d.save},{default:a(()=>[i(" Save ")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(T,{modelValue:e.dialogDelete,"onUpdate:modelValue":s[5]||(s[5]=l=>e.dialogDelete=l),"max-width":"500px"},{default:a(()=>[t(b,null,{default:a(()=>[t(y,{class:"text-h5"},{default:a(()=>[i("Are you sure you want to delete this item?")]),_:1}),t(C,null,{default:a(()=>[t(k),t(u,{color:"blue-darken-1",variant:"text",onClick:d.closeDelete},{default:a(()=>[i("Cancel")]),_:1},8,["onClick"]),t(u,{color:"blue-darken-1",variant:"text",onClick:d.deleteItemConfirm},{default:a(()=>[i("OK")]),_:1},8,["onClick"]),t(k)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),"item.account_name":a(({item:l})=>[i(m(l.raw.account_name.length>15?l.raw.account_name.slice(0,15).trim()+"...":l.raw.account_name),1)]),"item.trails_table":a(({item:l})=>[i(m(l.raw.trails_table.length>15?l.raw.trails_table.slice(0,15).trim()+"...":l.raw.trails_table),1)]),_:1},8,["items","headers","loading","search","sort-by","onClick:row"])]),_:1})}const te=D(X,[["render",ee]]);const ae={data:()=>({loading:!0,search:"",dialog:!1,dialogDelete:!1,editedIndex:-1,formTitle:"",trails:[],states:[],sortBy:[],editedItem:{UUID:"",mtb_id:"",name:"",city:"",state:"",center_latitude:null,center_longitude:null},defaultItem:{UUID:"",mtb_id:"",name:"",city:"",state:"",center_latitude:null,center_longitude:null},headers:[{title:"MTB ID",value:"mtbID",sortable:!0},{title:"Name",value:"name",key:"name",sortable:!0},{title:"City",value:"city",sortable:!0},{title:"State",value:"state.name",sortable:!0},{title:"Status",value:"status.mtbStatus",sortable:!0},{title:"Weather",value:"weather.notes",sortable:!0},{title:"UUID",value:"uuid",align:" d-none"}]}),methods:{async loadTrails(){this.loading=!0;try{this.trails=await _.getTrails(!1),this.states=await _.getStates(),this.loading=!1}catch{this.loading=!1}},editItem(e){this.editedIndex=this.trails.indexOf(e),this.editedItem=Object.assign({},e),this.formTitle="Edit Trail",(e.mtbId||e.mtbID)&&(this.editedItem.mtb_id=e.mtbId||e.mtbID),e.centerLatitude&&(this.editedItem.center_latitude=e.centerLatitude),e.centerLongitude&&(this.editedItem.center_longitude=e.centerLongitude),this.dialog=!0},deleteItem(e){this.editedIndex=this.trails.indexOf(e),this.editedItem=Object.assign({},e),this.formTitle="",this.dialogDelete=!0},async deleteItemConfirm(){await _.deleteTrail(this.editedItem.UUID),await this.loadTrails(),this.closeDelete()},close(){this.dialog=!1,this.formTitle="",this.$nextTick(()=>{this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1})},closeDelete(){this.dialogDelete=!1,this.$nextTick(()=>{this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1})},async save(){this.editedIndex>-1?await _.editTrail(this.editedItem.UUID,this.editedItem):await _.createTrail(this.editedItem),await this.loadTrails(),this.close()},handleClick(e,s){const h=s.item.raw;this.$router.push(`/trails/${h.uuid||h.UUID}`)}},created(){this.loadTrails()}},le=e=>(O("data-v-e2a4da30"),e=e(),L(),e),se=le(()=>c("span",{class:"headline"},"Trails",-1)),ie={class:"text-h5"};function de(e,s,h,S,A,d){const p=v("v-data-table");return n(),r(b,{rounded:"lg",width:"100%"},{default:a(()=>[t(y,null,{default:a(()=>[se]),_:1}),t(M),t(p,{items:e.trails,headers:e.headers,loading:e.loading,search:e.search,"sort-by":e.sortBy,"onUpdate:sortBy":s[9]||(s[9]=l=>e.sortBy=l),"item-key":"uuid","onClick:row":d.handleClick},{top:a(()=>[t(o,{class:"d-flex mt-4",style:{"align-items":"center","max-width":"100%"}},{default:a(()=>[t(f,{modelValue:e.search,"onUpdate:modelValue":s[0]||(s[0]=l=>e.search=l),label:"Search",class:"mr-4 ml-5"},null,8,["modelValue"]),t(T,{modelValue:e.dialog,"onUpdate:modelValue":s[7]||(s[7]=l=>e.dialog=l),"max-width":"500px"},{activator:a(({props:l})=>[t(u,j({color:"primary",dark:"",class:"mb-2 mr-5 ml-2"},l),{default:a(()=>[i(" New Trail ")]),_:2},1040)]),default:a(()=>[t(b,null,{default:a(()=>[t(y,null,{default:a(()=>[c("span",ie,m(e.formTitle||"Add Trail"),1)]),_:1}),t(U,null,{default:a(()=>[t(I,null,{default:a(()=>[t(o,null,{default:a(()=>[t(g,null,{default:a(()=>[t(f,{modelValue:e.editedItem.mtb_id,"onUpdate:modelValue":s[1]||(s[1]=l=>e.editedItem.mtb_id=l),label:"MTB ID"},null,8,["modelValue"])]),_:1}),t(g,null,{default:a(()=>[t(f,{modelValue:e.editedItem.name,"onUpdate:modelValue":s[2]||(s[2]=l=>e.editedItem.name=l),label:"Trail Name"},null,8,["modelValue"])]),_:1})]),_:1}),t(o,null,{default:a(()=>[t(g,null,{default:a(()=>[t(f,{modelValue:e.editedItem.city,"onUpdate:modelValue":s[3]||(s[3]=l=>e.editedItem.city=l),label:"City"},null,8,["modelValue"])]),_:1}),t(g,null,{default:a(()=>[t(R,{modelValue:e.editedItem.state,"onUpdate:modelValue":s[4]||(s[4]=l=>e.editedItem.state=l),items:e.states,"item-title":"name","item-value":"UUID",label:"State"},null,8,["modelValue","items"])]),_:1})]),_:1}),t(o,null,{default:a(()=>[t(g,null,{default:a(()=>[t(f,{modelValue:e.editedItem.center_latitude,"onUpdate:modelValue":s[5]||(s[5]=l=>e.editedItem.center_latitude=l),label:"Latitude",type:"number"},null,8,["modelValue"])]),_:1}),t(g,null,{default:a(()=>[t(f,{modelValue:e.editedItem.center_longitude,"onUpdate:modelValue":s[6]||(s[6]=l=>e.editedItem.center_longitude=l),label:"Longitude",type:"number"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),t(C,null,{default:a(()=>[t(k),t(u,{color:"blue-darken-1",variant:"text",onClick:d.close},{default:a(()=>[i(" Cancel ")]),_:1},8,["onClick"]),t(u,{color:"blue-darken-1",variant:"text",onClick:d.save},{default:a(()=>[i(" Save ")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(T,{modelValue:e.dialogDelete,"onUpdate:modelValue":s[8]||(s[8]=l=>e.dialogDelete=l),"max-width":"500px"},{default:a(()=>[t(b,null,{default:a(()=>[t(y,{class:"text-h5"},{default:a(()=>[i("Are you sure you want to delete this trail?")]),_:1}),t(C,null,{default:a(()=>[t(k),t(u,{color:"blue-darken-1",variant:"text",onClick:d.closeDelete},{default:a(()=>[i("Cancel")]),_:1},8,["onClick"]),t(u,{color:"blue-darken-1",variant:"text",onClick:d.deleteItemConfirm},{default:a(()=>[i("OK")]),_:1},8,["onClick"]),t(k)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),"item.name":a(({item:l})=>[i(m(l.raw.name.length>15?l.raw.name.slice(0,15).trim()+"...":l.raw.name),1)]),_:1},8,["items","headers","loading","search","sort-by","onClick:row"])]),_:1})}const ne=D(ae,[["render",de],["__scopeId","data-v-e2a4da30"]]),B={async getServerStatus(){try{return(await E.get("/rest/api/heartbeat")).data.state===1?"Running":"Restarting"}catch{return"Errored"}}},oe={async checkSocials(){return(await E.post("/rest/api/check-socials")).data}};const re={data:()=>({links:[{name:"Dashboard",focus:"dashboard"},{name:"Social Media Accounts",focus:"social-media-accounts"},{name:"Trails",focus:"trails"}],accountNum:0,trailNum:0,statusNum:0,interval:null,serverStatus:null,darkMode:!1,buttonText:"Run Check",checkClass:"",focus:"dashboard",disabledCheck:!1}),methods:{async loadData(){this.statusNum=0,this.statusNum=await _.getStatusCount()},async runCheck(){this.buttonText="Running",this.checkClass="yellow-lighten-1",this.disabledCheck=!0;try{const e=await oe.checkSocials();this.buttonText=`Updated ${e.numberUpdated} Trails!`,this.checkClass="green-lighten-1",this.disabledCheck=!1}catch(e){this.buttonText="Errored!",console.error(e),this.checkClass="red-lighten-1"}finally{setTimeout(()=>{this.buttonText="Run Check",this.checkClass="",this.disabledCheck=!1},5e3),await this.$refs.accountManager.loadAccounts(),await this.loadData()}},changeFocus(e){this.focus=e}},components:{NumberDisplayer:Q,AccountManager:te,TrailManager:ne},mounted(){this.$watch(()=>this.$refs.accountManager.accounts,e=>{this.accountNum=e.length}),this.$watch(()=>this.$refs.accountManager.trails,e=>{this.trailNum=e.length}),B.getServerStatus().then(e=>{this.serverStatus=e}),this.loadData(),this.interval=setInterval(async()=>{this.serverStatus=await B.getServerStatus()},5e3)},unmounted(){clearInterval(this.interval)}},ue=e=>(O("data-v-c8e6594b"),e=e(),L(),e),ce={class:"mb-6 pa-6 bg-grey-lighten-1 rounded-lg"},me=ue(()=>c("div",null,"Server Status",-1)),he={class:"d-flex justify-start align-center gap-5"},fe={class:"text-h4 text--primary"};function ge(e,s,h,S,A,d){const p=v("NumberDisplayer"),l=v("AccountManager"),x=v("TrailManager");return n(),r(P,{id:"inspire"},{default:a(()=>[t(W,{flat:""},{default:a(()=>[t(I,{class:"fill-height d-flex align-center wide"},{default:a(()=>[(n(!0),F(H,null,z(e.links,$=>(n(),r(u,{key:$,variant:"text",onClick:be=>d.changeFocus($.focus)},{default:a(()=>[i(m($.name),1)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1}),e.focus==="dashboard"?(n(),r(I,{key:0,class:"fill-height",style:{padding:"0"}},{default:a(()=>[t(N,{class:"bg-grey-lighten-3"},{default:a(()=>[t(I,null,{default:a(()=>[t(o,{justify:"center",dense:""},{default:a(()=>[c("div",ce,[t(o,{align:"center"},{default:a(()=>[t(b,{rounded:"lg",class:"ma-2"},{default:a(()=>[t(U,null,{default:a(()=>[me,c("div",he,[c("p",fe,m(this.serverStatus||"Unknown"),1),this.serverStatus==="Running"?(n(),r(w,{key:0,icon:"mdi-check-circle-outline",size:"large",color:"green-darken-2"})):this.serverStatus==="Restarting"?(n(),r(w,{key:1,icon:"mdi-minus-circle-outline",size:"large",color:"yellow-darken-2"})):this.serverStatus==="Errored"?(n(),r(w,{key:2,icon:"mdi-alpha-x-circle-outline",size:"large",color:"red-darken-2"})):(n(),r(w,{key:3,icon:"mdi-help-circle-outline",size:"large",color:"blue-grey-darken-2"}))])]),_:1})]),_:1}),t(p,{name:"Number of Accounts",number:e.accountNum},null,8,["number"]),t(p,{name:"Number of Trails",number:e.trailNum},null,8,["number"]),t(p,{name:"Number of Updates",number:e.statusNum},null,8,["number"]),t(M,{thickness:5,inset:"",vertical:""}),t(u,{height:"90","min-width":"164",class:"ml-2",color:e.checkClass,disabled:e.disabledCheck,onClick:d.runCheck},{default:a(()=>[i(m(e.buttonText),1)]),_:1},8,["color","disabled","onClick"])]),_:1})]),t(o,{class:"wide mb-5"},{default:a(()=>[t(l,{ref:"accountManager"},null,512)]),_:1}),t(o,{class:"wide mt-5"},{default:a(()=>[t(x,{class:"mt-5"})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):e.focus==="social-media-accounts"?(n(),r(I,{key:1,class:"fill-height",style:{padding:"0"}},{default:a(()=>[t(N,{class:"bg-grey-lighten-3 fill-height",style:{width:"100%"}},{default:a(()=>[t(o,{class:"mt-5",justify:"center"},{default:a(()=>[t(l,{ref:"accountManager",style:{width:"90% !important"}},null,512)]),_:1})]),_:1})]),_:1})):e.focus==="trails"?(n(),r(I,{key:2,class:"fill-height",style:{padding:"0"}},{default:a(()=>[t(N,{class:"bg-grey-lighten-3 fill-height",style:{width:"100%"}},{default:a(()=>[t(o,{class:"mt-5",justify:"center"},{default:a(()=>[t(x,{style:{width:"90% !important"}})]),_:1})]),_:1})]),_:1})):K("",!0)]),_:1})}const ke=D(re,[["render",ge],["__scopeId","data-v-c8e6594b"]]);export{ke as default};
